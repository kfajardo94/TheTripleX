<div class="divGeneral">
  <div class="divTable">
    <div class="divTitulo">
      <span>{{'titulo.categorias' | translate}}</span>
    </div>
    <p>
      <button type="button" class="btn btn-dark" (click)="collapse.toggle()" [attr.aria-expanded]="!this.filtroCerrado"
              aria-controls="collapseExample">
        {{'filtros' | translate}}
      </button>
    </p>
    <div #collapse="ngbCollapse" [(ngbCollapse)]="this.filtroCerrado">
      <div class="text-white">
        <form [formGroup]="formFiltros" (submit)="filtrar(collapse)">
          <div class="modal-body">
            <div class="form-group col-sm-6" style="margin: 0 auto;">
              <label>{{'id' | translate}}</label>
              <div class="input-group" >
                <input type="number" class="form-control" maxlength="10" size="10" width="100" formControlName="id"
                       oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);">
              </div>
              <label>{{'categorias.nombre' | translate}}</label>
              <div class="input-group" >
                <input type="text" class="form-control" maxlength="50" formControlName="nombre">
              </div>
            </div>
          </div>
          <div class="divFooter">
            <div style="float: right; right: 50%; position: relative;">
              <div style="float: right; right: -50%; position: relative;">
                <button type="submit" class="btn btn-light" ><i class="fas fa-search"></i></button>
                <button type="button" (click)="limpiarFiltros()" class="btn btn-danger" ><i class="fas fa-times"></i></button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div>
      <button class="btn botonAgregarGeneral" (click)="modal(content, 1, null)"><i class="fas fa-file"></i></button>
      <div class="divTableCustom">
        <table class="table table-striped">
          <thead>
          <tr>
            <th scope="col">{{'id' | translate}}</th>
            <th scope="col">{{'categorias.nombre' | translate}}</th>
            <th scope="col">{{'acciones' | translate}}</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let categoria of categorias; let i = index;" [class.tdPar]="(i+1) % 2 !== 0" [class.tdImpar]="(i+1) % 2 === 0">
            <td>{{categoria.id}}</td>
            <td><span>{{categoria.nombre}}</span></td>
            <td>
              <button (click)="modal(content, 3, categoria)"><i class="fas fa-search"></i></button>
              <button (click)="modal(content, 2, categoria)"><i class="fas fa-pen"></i></button>
              <button (click)="modalEliminar(contentEliminar, categoria)"><i class="fas fa-trash"></i></button>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="divPagination1" *ngIf="pagination.collectionSize > 0">
      <div class="divPagination2">
        <ngb-pagination class="ngbPaginationClass"
          [(page)]="pagination.page"
          (pageChange)="changePage($event-1)"
          [maxSize]="pagination.maxSize"
          [pageSize]="pagination.pageSize"
          [collectionSize]="pagination.collectionSize"></ngb-pagination>
      </div>
    </div>
    <div class="divPagination3">
      <div class="divPagination4">
        <span>{{'registros.pagina' | translate}} {{pagination.pageSize}}  </span>
        <div ngbDropdown placement="top-left" class="d-inline-block">
          <button class="btn btn-dark" id="dropdownBasic1" ngbDropdownToggle>
          </button>
          <div ngbDropdownMenu class="bg-dark divPageSize" aria-labelledby="dropdownBasic1">
            <button ngbDropdownItem class="text-white text-center" (click)="changeSize(5)">5</button>
            <button ngbDropdownItem class="text-white text-center" (click)="changeSize(10)">10</button>
            <button ngbDropdownItem class="text-white text-center" (click)="changeSize(20)">20</button>
            <button ngbDropdownItem class="text-white text-center" (click)="changeSize(50)">50</button>
            <button ngbDropdownItem class="text-white text-center" (click)="changeSize(100)">100</button>
          </div>
        </div>
        <span>{{'total.registros' | translate}} {{pagination.collectionSize}}</span>
      </div>
    </div>
  </div>

</div>

<ng-template #content let-modal>
  <div class="modal-header badge-dark">
    <h4 class="modal-title" id="modal-basic-title">{{nombreAccion | translate}} {{'titulo.categorias.crud' | translate}}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <ngb-alert type="{{type}}" *ngIf="mostrarMensaje" [dismissible]="false">{{mensaje}}</ngb-alert>
  <form [formGroup]="form" (submit)="guardar()" >
    <div class="modal-body">
      <div class="form-group">
        <div *ngIf="this.modo !== 1">
          <label>{{'id' | translate}}</label>
          <div class="input-group" >
            <input type="text" class="form-control" maxlength="10" formControlName="id" >
          </div>
        </div>
        <label>{{(this.modo === 1 || modo === 2) ? ('categorias.nombre' | translate) + '*' : 'categorias.nombre' | translate}}</label>
        <div class="input-group" >
          <input id="inputNombre" type="text" class="form-control" maxlength="50" formControlName="nombre" (blur)="limpiarControls('nombre')" >
        </div>
      </div>
    </div>
    <div class="modal-footer divFooter">
      <button type="button" (click)="modal.close()" class="btn btn-danger" [disabled]="deshabilitarBotones"><i class="fas fa-times"></i></button>
      <button type="submit" class="btn btn-success" [disabled]="this.form.invalid || deshabilitarBotones" *ngIf="modo !== 3 && modo !== 4"><i class="fas fa-check"></i></button>
    </div>
  </form>

</ng-template>


<ng-template #contentEliminar let-modal>
  <div class="modal-header badge-dark">
    <h4 class="modal-title" id="modal-basic-title-delete">{{'eliminar' | translate}} {{'titulo.categorias.crud' |
      translate}}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <ngb-alert type="{{type}}" *ngIf="mostrarMensaje" [dismissible]="false">{{mensaje}}</ngb-alert>
  <form [formGroup]="form" (submit)="eliminar()">
    <div class="modal-body">
      <div class="form-group divMensajeEliminar">
        <span>{{'confirmar.eliminar' | translate}} {{this.form.controls.id.value}} - {{this.form.controls.nombre.value}}</span>
      </div>
    </div>
    <div class="modal-footer divFooter">
      <button type="button" (click)="modal.close()" class="btn btn-danger" [disabled]="deshabilitarBotones"><i class="fas fa-times"></i></button>
      <button type="submit" class="btn btn-success" [disabled]="deshabilitarBotones"><i class="fas fa-check"></i></button>
    </div>
  </form>

</ng-template>
